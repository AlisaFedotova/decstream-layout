<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>No device</title>
</head>
<body>
<div class="modal fade" id="addhard" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="addDeviceModalTitle">ДОБАВЛЕНИЕ УСТРОЙСТВА</h2>
      </div>
      <div class="modal-body" id="selectDeviceOrGroup">
        <button class="btn btn-primary w-100 mb-4" onclick="$('#selectDeviceOrGroup,#addVirtualDeviceTile').hide();$('#addDeviceTile').show();">
          Устройство
        </button>
        <button class="btn btn-primary w-100 mb-4" onclick="$('#selectDeviceOrGroup').hide();$('#addVirtualDeviceTile,#addVirtualDeviceTypeTile').show();">
          <span>Прибор учёта</span>
          <span>с импульсным выходом</span>
        </button>
      </div>
      <script>
        var vType = '';
        var sourceDevices = [];
        var selectedDeviceIterator = -1;
        var selectedFunctionIterator = -1;
        var newVirtualDeviceName = '';
        var newVirtualDeviceSerial = '';
        var newVirtualDeviceFactor = 0;
        var newVirtualDeviceCost = 0;
        var newVirtualDevicePurpose = 'NONE';
        var sourceDeviceTemperatureFuncId = -1;

        function createVirtualDeviceCallback(data) {
          console.log(data);
          if (!data.virtualDeviceCreation.status)
            notifyError(data.virtualDeviceCreation.error);
          else
            document.location.href = "./?/devices/info/?id=" + data.virtualDeviceCreation.device.device.id;
        }

        function createVirtualDeviceFinish() {
          newVirtualDevicePurpose = $('#addVirtualDevicePurposeSelect').val();
          currentValue = $('#addVirtualDeviceFactorInput').val();
          newVirtualDeviceCost = $('#addVirtualDeviceCostInput').val();
          rcmsQuery('devices/add/?virtual', {
            type: vType,
            sourceDeviceId: sourceDevices[selectedDeviceIterator].id,
            sourceFunctionId: sourceDevices[selectedDeviceIterator].functions[selectedFunctionIterator].id,
            sourceFunctionValue: sourceDevices[selectedDeviceIterator].functions[selectedFunctionIterator].data.count,
            name: newVirtualDeviceName,
            serial: newVirtualDeviceSerial,
            currentValue: currentValue,
            cost: newVirtualDeviceCost,
            purpose: newVirtualDevicePurpose,
            temperatureFunc: sourceDeviceTemperatureFuncId
          }, createVirtualDeviceCallback, null);
        }

        function createVirtualDeviceToFactor() {
          newVirtualDeviceName = $('#addVirtualDeviceNameInput').val();
          newVirtualDeviceSerial = $('#addVirtualDeviceSerialInput').val();
          if (newVirtualDeviceName == '' || newVirtualDeviceSerial == '')
            notifyWarn('Все поля обязательны к заполнению!');
          else {
            $('#addVirtualDeviceCostAndFactor').show();
            $('#addVirtualDeviceNameAndSerial').hide();
            if (vType == 'WATER_COUNTER')
              $('#addVirtualWaterPurpose').show();
            else
              $('#addVirtualWaterPurpose').hide();
          }
        }

        function createVirtualDeviceSelectSourceExit(func_id) {
          selectedFunctionIterator = func_id;
          $('#addVirtualDeviceNameInput, #addVirtualDeviceSerialInput').val('');
          $('#addVirtualDeviceNameAndSerial').show();
          $('#addVirtualDeviceSelectExit').hide();

        }

        function createVirtualDeviceSelectSource(id) {
          selectedDeviceIterator = id;
          $('#addVirtualDeviceSelectSource').hide();
          $('#addVirtualDeviceSelectExit').show();
          var $select = $('#virtualDeviceSelectSourceExit');
          $select.html('');

          for (var i = 0; i < sourceDevices[id].functions.length; i++) {
            if (sourceDevices[id].functions[i].type == 'THERMOMETER')
              sourceDeviceTemperatureFuncId = sourceDevices[id].functions[i].id;
            else {
              if (sourceDevices[id].functions[i].type == 'IMPULSE_COUNTER')
                $select.append($("<div class=\"borderIndicator\">" +
                  "<a onclick=\"createVirtualDeviceSelectSourceExit(" + i + ")\" style=\"cursor: pointer;\">" +
                  "<li class=\"text-primary\"><b class=\"p-2\">" + sourceDevices[id].functions[i].name + "</b></li></a>" +
                  "</div>", null));
            }
          }

        }

        function getSourceDevicesCallback(data) {
          console.log(data);
          var $select = $('#virtualDeviceSelectSource');
          $select.html('');
          //for(var j = 0; j < 20; j++)
          sourceDevices = data.sourceDevices.data.device_contexts;
          for (var i = 0; i < data.sourceDevices.data.device_contexts.length; i++) {
            $select.append($("<div class=\"borderIndicator\">" +
              "<a onclick=\"createVirtualDeviceSelectSource(" + i + ")\" style=\"cursor: pointer;\">" +
              "<li class=\"text-primary\"><b class=\"p-2\">" + data.sourceDevices.data.device_contexts[i].name + "</b></li></a>" +
              "</div>", null));
          }
        }

        function createVirtualDeviceSelectType(type) {
          vType = type;
          var typeName = 'ДОБАВИТЬ ';
          switch (vType) {
            case 'WATER_COUNTER':
              typeName += 'ВОДОСЧЁТЧИК';
              break;
            case 'ELECTRICITY_COUNTER':
              typeName += 'ЭЛЕКТРОСЧЁТЧИК';
              break;
            case 'GAS_COUNTER':
              typeName += 'ГАЗОСЧЁТЧИК';
              break;
          }
          $('#addDeviceModalTitle').html(typeName);
          $('#addVirtualDeviceTypeTile').hide();
          $('#addVirtualDeviceSelectSource').show();
          rcmsQuery('organization/devices/?getSourceDevices', null, getSourceDevicesCallback, null);
        }
      </script>
      <div class="modal-body" id="addVirtualDeviceTile">
        <div id="addVirtualDeviceTypeTile" style="display:none;">
          <ul class="listcomp" style="padding-inline-start: 10px;">
            <div class="borderIndicator">
              <a onclick="createVirtualDeviceSelectType('WATER_COUNTER')" style="cursor: pointer;">
                <li class="text-primary"><b class="p-2">Водосчётчик</b></li>
              </a>
            </div>
            <div class="borderIndicator">
              <a onclick="createVirtualDeviceSelectType('ELECTRICITY_COUNTER')" style="cursor: pointer;">
                <li class="text-primary"><b class="p-2">Электросчётчик</b></li>
              </a>
            </div>
            <div class="borderIndicator">
              <a onclick="createVirtualDeviceSelectType('GAS_COUNTER')" style="cursor: pointer;">
                <li class="text-primary"><b class="p-2">Газосчётчик</b></li>
              </a>
            </div>
          </ul>

          <div class="row w-100">
            <div class="col-6" style="margin-left:10px;">
              <button type="button" onclick="$('#addVirtualDeviceTypeTile').hide();$('#selectDeviceOrGroup').show();" class="btn btn-link" style="text-decoration: underline; height:60px;text-align: left;">Назад
              </button>
            </div>
          </div>
        </div>
        <div id="addVirtualDeviceSelectSource" class="row text-center" style="display:none;">
          <div class="col-sm">
            <ul id="virtualDeviceSelectSource" class="listcomp">
            </ul>
            <div class="row w-100">
              <div class="col-6" style="margin-left:10px;">
                <button type="button" onclick="$('#addVirtualDeviceSelectSource').hide();$('#addVirtualDeviceTypeTile').show();" class="btn btn-link" style="text-decoration: underline; height:60px;text-align: left;">Назад
                </button>
              </div>
            </div>
          </div>
        </div>
        <div id="addVirtualDeviceSelectExit" class="row text-center" style="display:none;">
          <div class="col-sm">
            <ul id="virtualDeviceSelectSourceExit" class="listcomp">
            </ul>
            <div class="row w-100">
              <div class="col-6" style="margin-left:10px;">
                <button type="button" onclick="$('#addVirtualDeviceSelectExit').hide();$('#addVirtualDeviceSelectSource').show();" class="btn btn-link" style="text-decoration: underline; height:60px;text-align: left;">Назад
                </button>
              </div>
            </div>
          </div>
        </div>
        <div id="addVirtualDeviceNameAndSerial" class="row text-center" style="display:none">
          <p>Введите название и серийный номер добавляемого устройства</p>
          <input type="text" class="form-control fields2 p-4" id="addVirtualDeviceNameInput" placeholder="Название">
          <input type="text" class="form-control fields2 p-4 mt-4" id="addVirtualDeviceSerialInput" placeholder="Серийный номер">

          <div class="row w-100" style="">
            <div class="col-6" style="margin-left:10px;">
              <button type="button" onclick="$('#addVirtualDeviceNameAndSerial').hide();$('#addVirtualDeviceSelectExit').show();" class="btn btn-link p-3 mt-4 w-100" style="text-decoration: underline; height:60px;text-align: left;">Назад
              </button>
            </div>
            <div class="col-6" style="position:absolute;right:0;">
              <button type="button" onclick="createVirtualDeviceToFactor()" class="w-100 btn btn-primary btn-radius mt-4 py-3 text-center">Далее
              </button>
            </div>
          </div>

        </div>
        <div id="addVirtualDeviceCostAndFactor" class="row text-center" style="display:none">
          <p>Введите цену одного импульса и текущие показания счетчика</p>
          <input type="number" class="form-control fields2 p-4 my-2" id="addVirtualDeviceCostInput" placeholder="Цена импульса">
          <input type="number" class="form-control fields2 p-4 my-2" id="addVirtualDeviceFactorInput" placeholder="Текущие показания">
          <div id="addVirtualWaterPurpose" class="w-100" style="display:none;">
            <div class="row mt-2">
              <div class="col-6 text-left pt-3">
                <span>Назначение</span>
              </div>
              <div class="col-6">
                <select class="form-control w-100" style="margin-top:-5px" id="addVirtualDevicePurposeSelect">
                  <option value="NONE">Не задано</option>
                  <option value="COLD_WATER">Холодная вода</option>
                  <option value="HOT_WATER">Горячая вода</option>
                </select>
              </div>
            </div>
          </div>

          <div class="row w-100" style="">
            <div class="col-6" style="margin-left:10px;">
              <button type="button" onclick="$('#addVirtualDeviceCostAndFactor').hide();$('#addVirtualDeviceNameAndSerial').show();" class="btn btn-link p-3 mt-4 w-100" style="text-decoration: underline; height:60px;text-align: left;">Назад
              </button>
            </div>
            <div class="col-6" style="position:absolute;right:0;">
              <button type="button" onclick="createVirtualDeviceFinish()" class="btn w-100 btn-primary btn-radius mt-4 py-3 text-center">Добавить
              </button>
            </div>
          </div>

        </div>

      </div>
      <div class="modal-body" id="addDeviceTile">
        <script>
          function addSimpleDeviceCallback(data) {
            if (data.addDeviceResult.status)
              location.reload();
            else
              notifyError(data.addDeviceResult.message);
          }

          function addSimpleDevice() {
            rcmsQuery('devices/add/?group=', {addDevice: true, deviceEui: $('#deviceDevEUI').val()}, addSimpleDeviceCallback, null);
          }
        </script>
        <p>Введите номер устройства (DEV EUI) написанный на коробке.</p>
        <div class="form-group">
          <label for="deviceDevEUI">Номер устройства</label>
          <input type="text" class="form-control" id="deviceDevEUI">
        </div>
        <button class="btn btn-primary" onclick="addSimpleDevice()">
          ДОБАВИТЬ
        </button>
      </div>
      <div class="modal-body text-center" id="addGroupTile" style="display:none;">
        <p>Введите название группы.</p>
        <script>
          function createGroupCallback(data) {
            if (data.groupCreateResult.status)
              document.location.reload();
            else
              notifyError(data.groupCreateResult.error);
          }

          function createGroup() {
            rcmsQuery('devices/add/?group=&addGroup', {groupName: $('#addGroupInput').val()}, createGroupCallback, null);
          }
        </script>
        <form method="POST" id="createGroupForm" action="/?/devices/add/?group=&amp;addGroup">
          <input type="text" class="form-control fields2 p-4" id="addGroupInput" name="groupName" placeholder="Название группы">
          <button type="button" onclick="createGroup()" class="w-100 btn btn-primary btn-radius mt-4 py-3 text-center" name="addGroup">ДОБАВИТЬ
          </button>
        </form>
        <script>
          $("#createGroupForm").submit(function (e) {
            createGroup();
            return false;
          });
        </script>
      </div>
    </div>
  </div>
</div>
<script>
  $('#addhard').on('shown.bs.modal', function () {
    $('#addHardInput').focus()
  });
  $('#addhard').on('hidden.bs.modal', function () {
    $('#addHardInput,#addGroupInput').val('');
    $('#selectDeviceOrGroup').show();
    $('#addDeviceModalTitle').html('ДОБАВЛЕНИЕ УСТРОЙСТВА');
    $('#addDeviceTile,#addGroupTile,#addVirtualDeviceCostAndFactor,#addVirtualDeviceNameAndSerial,#addVirtualDeviceSelectExit,#addVirtualDeviceSelectSource,#addVirtualDeviceTypeTile').hide();


  })
  ;

</script><div class="modal fade" id="editfilterevents" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <button type="button" class="close bg-danger bclose" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">×</span>
      </button>
      <div class="modal-body text-center">
        <h5 class="modal-title p-3" id="exampleModalLabel">НАСТРОЙКА ФИЛЬТРОВ</h5>
        <div class="row">
          <div class="col-sm p-4">
            <form class="container" method="POST" action="./?/events/">
              <div class="form-group row text-left">
                <div class="col-sm-12 checksv checkbox">
                </div>
              </div>
              <div class="row">
                <div class="mt-5 text-left col-sm-6">
                  <a href="./?/events/" class="text-danger">Сбросить все фильтры</a>
                </div>
                <div class="mt-5 text-right col-sm-6">
                  <button type="submit" class="btn btn-primary btn-radius p-3">Применить</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  $('#editfilterevents').on('hidden.bs.modal', function () {
    document.getElementById('groupDevices').checked = $('#groupDevices').attr('def-val') == 'checked';
  });
  function changeTypeOnSwitch()
  {
    if($('#groupDevices').prop('checked'))
      document.getElementById('filterForm').action = './?/organization/groups/?group=';
    else
      document.getElementById('filterForm').action = './?/organization/devices/';
  }
</script><div class="modal fade" id="editfilterfunctiontypes" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <button type="button" class="close bg-danger bclose" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">×</span>
      </button>
      <div class="modal-body text-center">
        <h5 class="modal-title p-3" id="exampleModalLabel">НАСТРОЙКА ФИЛЬТРОВ</h5>
        <div class="row">
          <div class="col-sm p-4">
            <form class="container" id="filterForm" method="POST" action="./?/organization//?group=">
              <div class="form-group row text-left">
                <div class="col-sm-12 checksv checkbox">
                  <div class="pb-3">
                    <input id="groupDevices" type="checkbox" name="groupDevices" def-val="" value="">
                    <label for="groupDevices" style="line-height:1;">Группировать устройства</label>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="mt-5 text-left col-sm-6">
                  <a href="./?/organization/?removeFunctionTypeFilters" class="text-danger">Сбросить все фильтры</a>
                </div>
                <div class="mt-5 text-right col-sm-6">
                  <button type="submit" class="btn btn-primary btn-radius p-3" onclick="changeTypeOnSwitch()">Применить</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  $('#editfilterfunctiontypes').on('hidden.bs.modal', function ()
  {
  });
  function onUserChangeFilters(elementId)
  {
    document.getElementById('uncheck_'+elementId).name = document.getElementById(elementId).checked ? '' : 'removeFunctionTypeFilterItems['+elementId+']';
  }
</script><div class="modal userbox-modal fade" id="organizationsInfo" tabindex="-1" role="dialog" aria-labelledby="organizationInfoLabel" aria-modal="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="exampleModalLabel">Информация об аккаунте</h2>
        <button type="button" class="close mobile-only" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="btn-close"></span>
        </button>
      </div>
      <div class="modal-body">
        <div>
          <p>User Test Superr</p>
          <a href="#">user@user.ru</a>
        </div>
        <div class="d-flex userbox-buttons">
          <a role="button" href="./?/profile/" class="btn btn-primary btn-custom w-text-uppercase">ИЗМЕНИТЬ</a>
          <a role="button" href="./?/logout" class="btn btn-secondary btn-custom rounded-pill text-uppercase">ВЫЙТИ</a>
        </div>
        <ul class="list-group">
          <li class="list-group-item active"><a href="./?/?organization=10">
            <b>
              User T. S.
            </b>
          </a>
          </li>
          <li class="list-group-item "><a href="./?/?organization=3">

            Хорошая

          </a>
          </li>
          <li class="list-group-item "><a href="./?/?organization=8">

            УК

          </a>
          </li>
          <li class="list-group-item "><a href="./?/?organization=310">

            Томика23

          </a>
          </li>
          <li class="list-group-item "><a href="./?/?organization=1184">

            Тест 404 не трогать

          </a>
          </li>
          <li class="list-group-item "><a href="./?/?organization=261">

            ООО "Декстрим компани"

          </a>
          </li>
          <li class="list-group-item "><a href="./?/?organization=262">

            262

          </a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
<script>
  function changeProfileCallback(data) {
    console.log(data);
    if (data.profileChangeResponse.status) {
      notifyInfo(data.profileChangeResponse.message);
      $(
        '#orginfo > div > div > div > div.row.px-4.pt-1.pb-1 > div > p > b')
        .html(
          $('#changeProfileFirst').val() + " "
          + $('#changeProfileMiddle').val() + " "
          + $('#changeProfileLast').val());
      $(
        '#orginfo > div > div > div > div.row.px-4.pt-1.pb-1 > div > p > a')
        .html($('#changeProfileEmail').val());
      $('#changeProfileFirst').attr('def-val',
        $('#changeProfileFirst').val());
      $('#changeProfileMiddle').attr('def-val',
        $('#changeProfileMiddle').val());
      $('#changeProfileLast').attr('def-val',
        $('#changeProfileLast').val());
      $('#changeProfileEmail').attr('def-val',
        $('#changeProfileEmail').val());
      $('#nameinfo').modal('hide');
    } else
      notifyError(data.profileChangeResponse.error);
  }
  function changeProfileData() {
    rcmsQuery('profile/edit', {
      first : $('#changeProfileFirst').val(),
      middle : $('#changeProfileMiddle').val(),
      last : $('#changeProfileLast').val(),
      email : $('#changeProfileEmail').val()
    }, changeProfileCallback, null);
  }
</script>
<div class="modal fade" id="nameinfo" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content p-3">
      <button type="button" class="close bg-danger bclose" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">×</span>
      </button>
      <h6 class="modal-title pt-3" id="exampleModalLabel">ИЗМЕНЕНИЕ
        ДАННЫХ ПОЛЬЗОВАТЕЛЯ</h6>
      <div class="modal-body text-center">
        <div class="row">
          <div class="col-sm pb-4 ">
            <form method="POST" action="/?/profile/edit/">
              <div class="mb-4 position-relative inbox">
                <p>user@user.ru</p>
              </div>
              <div class="mb-4 position-relative inbox">
                <label class="toplabel d-none" for="lastNameInfo">Фамилия</label>
                <input type="text" class="form-control fields2" style="padding-left: 16px !important; padding-top: 26px !important;" name="last" id="changeProfileLast" def-val="User" value="User"><small class="text-danger text-truncate inftext">

              </small>
              </div>
              <div class="mb-4 position-relative inbox">
                <label class="toplabel d-none" for="exampleInputimya">Имя</label>
                <input type="text" class="form-control fields2" style="padding-left: 16px !important; padding-top: 26px !important;" name="first" id="changeProfileFirst" def-val="Test" value="Test"> <small class="text-danger text-truncate inftext">

              </small>
              </div>
              <div class="mb-4 position-relative inbox">
                <label class="toplabel d-none" for="exampleInputot">Отчество</label>
                <input type="text" class="form-control fields2" style="padding-left: 16px !important; padding-top: 26px !important;" name="middle" id="changeProfileMiddle" def-val="Superr" value="Superr"> <small class="text-danger text-truncate inftext">

              </small>
              </div>


              <button type="button" name="save" onclick="changeProfileData()" class="btn w-100 btn-primary p-3">СОХРАНИТЬ</button>
            </form></div>

        </div>
      </div>
    </div>

  </div>
</div>

<script>
  $('#nameinfo').on('shown.bs.modal', function() {
    $('#changeProfileLast').focus()
  });
  $('#nameinfo').on(
    'hidden.bs.modal',
    function() {
      $('#changeProfileLast').val(
        $('#changeProfileLast').attr('def-val'));
      $('#changeProfileFirst').val(
        $('#changeProfileFirst').attr('def-val'));
      $('#changeProfileMiddle').val(
        $('#changeProfileMiddle').attr('def-val'));
      $('#changeProfileEmail').val(
        $('#changeProfileEmail').attr('def-val'));
    });
</script>
<script type="text/javascript">

  function mySubmitFunction(e)
  {
    e.preventDefault();
    changePassCall();
    return false;
  }

  function changePassCallback(data)
  {
    console.log(data);
    if (data.profileChangeResponse.status)
    {
      $('#changePasswordModal').modal('hide');
      notifyInfo(data.profileChangeResponse.message);
      $('#changePassOldPass').val('');
      $('#changePassNewPass').val('');
      $('#changePassNewPassR').val('');
    }
    else
    {
      notifyError(data.profileChangeResponse.error);
    }
  }

  function changePassCall()
  {
    if ($('#changePassNewPass').val() == $('#changePassNewPassR').val())
    {
      rcmsQuery('profile/edit', {old_password: $('#changePassOldPass').val(), new_password: $('#changePassNewPass').val(), new_password_r: $('#changePassNewPassR').val()}, changePassCallback, null);
    }
    else
    {
      notifyWarn('Повтор пароля не совпадает с новым паролем');
      $('#changePassNewPassR').val('');
    }
  }
</script>

<div class="modal fade" id="changePasswordModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content p-3">
      <button type="button" class="close bg-danger bclose" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">×</span>
      </button>
      <h2 class="modal-title pt-3 text-left" id="exampleModalLabel">ИЗМЕНЕНИЕ ПАРОЛЯ</h2>
      <div class="modal-body text-center">
        <div class="row">
          <div class="col-sm p-4">
            <form method="POST" action="/?/profile/edit/" onsubmit="return mySubmitFunction(event)" oninput="new_password_r.setCustomValidity(new_password.value != new_password_r.value ? &quot;Повтор пароля не совпадает с новым паролем&quot; : &quot;&quot;)">
              <div class="mb-4 position-relative inbox">
                <label class="toplabel d-none" for="changePassOldPass">Старый пароль</label>
                <input type="password" class="form-control fields2" name="old_password" id="changePassOldPass" def-val=""><small class="text-danger text-truncate inftext"></small>
              </div>
              <div class="mb-4 position-relative inbox">
                <label class="toplabel d-none" for="changePassNewPass">Новый пароль</label>
                <input type="password" class="form-control fields2" name="new_password" id="changePassNewPass" def-val="">
              </div>
              <div class="mb-4 position-relative inbox">
                <label class="toplabel d-none" for="changePassNewPassR">Повторить пароль</label>
                <input type="password" class="form-control fields2" name="new_password_r" id="changePassNewPassR" def-val="">
              </div>
              <div class="row">
                <div class="text-right col-sm-12">
                  <button id="registerButton" name="save" type="submit" class="btn w-100 btn-primary p-3">Изменить</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  $('#changePasswordModal').on('hidden.bs.modal', function () {
    $('#changePassOldPass').val('');
    $('#changePassNewPass').val('');
    $('#changePassNewPassR').val('');
  });
</script>
<div class="modal fade" id="inviteAcceptModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content pb-2">
      <button type="button" class="close bg-danger bclose" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">×</span>
      </button>
      <div class="modal-body text-center">
        <h5 class="modal-title p-3" id="exampleModalLabel">ПРИГЛАШЕНИЕ В ОРГАНИЗАЦИЮ</h5>
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.552cm" height="1.552cm">
          <path fill-rule="evenodd" fill="rgb(74, 189, 126)" d="M22.253,43.061 C10.417,43.061 0.788,33.432 0.788,21.596 C0.788,9.760 10.417,0.131 22.253,0.131 C34.089,0.131 43.718,9.760 43.718,21.596 C43.718,33.432 34.089,43.061 22.253,43.061 ZM22.253,2.561 C11.757,2.561 3.218,11.100 3.218,21.596 C3.218,32.092 11.757,40.631 22.253,40.631 C32.749,40.631 41.288,32.092 41.288,21.596 C41.288,11.100 32.749,2.561 22.253,2.561 ZM20.731,28.883 C20.501,29.143 20.170,29.291 19.823,29.291 C19.549,29.291 19.279,29.197 19.064,29.026 L10.964,22.545 C10.710,22.342 10.551,22.053 10.515,21.730 C10.479,21.408 10.572,21.091 10.774,20.837 C10.977,20.584 11.266,20.425 11.589,20.389 C11.912,20.353 12.229,20.445 12.481,20.647 L19.681,26.407 L31.874,12.690 C32.091,12.446 32.387,12.302 32.712,12.283 C33.031,12.262 33.347,12.372 33.591,12.589 C33.833,12.803 33.977,13.100 33.996,13.424 C34.016,13.749 33.907,14.061 33.691,14.304 L20.731,28.883 Z"></path>
        </svg>
        <p>Ваше приглашение в организацию "" активировано.</p>
      </div>
    </div>
  </div>
</div>


<header>
  <div class="wrapper">
    <div class="left-part">
      <div class="left-part__wrapper">
        <div class="hamburger-menu">
          <input id="menu__toggle" type="checkbox" onclick="changePageScrolling()">
          <label class="menu__btn" for="menu__toggle">
            <span></span>
          </label>
          <div class="aside-menu menu__box container-fluid mt-3" id="homeSubmenuMobile">
            <div class="aside-menu-item">
              <a href="./?/" class="w-100 d-block active">
                <img src="./decstream_cp/public/images/menuIcons/jkh_active.svg">
                ЖКХ
              </a>
            </div>
            <div class="aside-menu-item">
              <a href="./?/organization/groups" class="w-100 d-block ">
                <img src="./decstream_cp/public/images/menuIcons/devices.svg">
                Список устройств
              </a>
            </div>
            <div class="aside-menu-item">
              <a href="./?/events/" class="w-100 d-block ">
                <img src="./decstream_cp/public/images/menuIcons/events.svg">
                Журнал событий
              </a>
            </div>
            <div class="aside-menu-item">
              <a href="./?/reports/" class="w-100 d-block ">
                <img src="./decstream_cp/public/images/menuIcons/reports.svg">
                Отчеты
              </a>
            </div>
            <div class="aside-menu-item">
              <a href="./?/members/" class="w-100 d-block ">
                <img src="./decstream_cp/public/images/menuIcons/users.svg">
                Пользователи и роли
              </a>
            </div>
            <div class="menu-bottom">
              <div class="userbox text-left align-items-center" style="cursor:pointer;" data-toggle="modal" data-target="#organizationsInfo">
                <div class="text-left">
                  User T. S.
                  <br>
                  <b>УК</b>
                </div>
                <i class="fa fa-angle-down pl-3" style="color:#c94e60; font-weight: 600;" aria-hidden="true"></i>
              </div>                         </div>
          </div>                </div>
        <script>
          function changePageScrolling() {
            let body = document.body;
            body.className = '';
            if ($('#menu__toggle').prop('checked')) {
              body.className = 'overflow-hidden';
            }
          }
        </script>                <div class="logo">
        <a href="/">
          <img src="./decstream_cp/public/images/logo.png" alt="logo">
        </a>
      </div>
      </div>
    </div>
    <div class="right-part pl-3">
      <div class="right-part__wrapper">
        <nav aria-label="breadcrumb" class="d-flex align-items-center w-100" id="breadcrumbs">
          <a class="bc-row-back" href="./?/"><img src="./decstream_cp/public/images/arrow-back.svg"></a>
          <ol class="breadcrumb align-items-center">

            <li class="breadcrumb-item"><a href="./?/">ЖКХ</a></li>
            <li class="breadcrumb-item"><a href="./?/?group=380">Очень важная группа для тестирования групп и адресов</a></li>
            <li class="breadcrumb-item"><a href="./?/?group=512">Очень</a></li>
            <li class="breadcrumb-item active" aria-current="page">Важная</li>
          </ol>
        </nav>
        <script>
          function hideBackBtn() {
            if (window.outerWidth < 768) {
              let block = document.querySelector('#breadcrumbs');
              let breadcrumbs = block.querySelectorAll('ol.breadcrumb>.breadcrumb-item');
              let backBtn = block.querySelector('.bc-row-back');
              backBtn.className = 'bc-row-back';
              if (breadcrumbs.length <= 1) {
                backBtn.className = backBtn.className + ' hide';
              }
            }
          }

          hideBackBtn();
          $(window).resize(function () {
              hideBackBtn();
            }
          )
        </script>
        <div class="userbox text-right align-items-center" style="cursor:pointer;" data-toggle="modal" data-target="#organizationsInfo">
          <div class="float-left">
            <span class="text-nowrap">User T. S.</span>
            <br>
            <b class="text-nowrap">УК</b>
          </div>
          <i class="fa fa-angle-down pl-3" style="color:#c94e60; font-weight: 600;" aria-hidden="true"></i>
        </div>                <div class="logo tablet-only p-0">
        <a href="/">
          <img src="./decstream_cp/public/images/logo.png" alt="logo">
        </a>
      </div>
      </div>
    </div>
  </div>
</header>
<div class="page-content" id="pageContent">
  <aside class="left-part">
    <div class="left-part__wrapper">
      <ul class="aside-menu container-fluid" id="homeSubmenu2">
        <li>
          <a href="./?/" class="w-100 d-block active">
            <img src="./decstream_cp/public/images/menuIcons/jkh_active.svg">
            ЖКХ
          </a>
        </li>
        <li>
          <a href="./?/organization/groups" class="w-100 d-block ">
            <img src="./decstream_cp/public/images/menuIcons/devices.svg">
            Список устройств
          </a>
        </li>
        <li>
          <a href="./?/events/" class="w-100 d-block ">
            <img src="./decstream_cp/public/images/menuIcons/events.svg">
            Журнал событий
          </a>
        </li>
        <li>
          <a href="./?/reports/" class="w-100 d-block ">
            <img src="./decstream_cp/public/images/menuIcons/reports.svg">
            Отчеты
          </a>
        </li>
        <li>
          <a href="./?/members/" class="w-100 d-block ">
            <img src="./decstream_cp/public/images/menuIcons/users.svg">
            Пользователи и роли
          </a>
        </li>
      </ul>        </div>
  </aside>
  <main id="mainBlock" class="right-part">
    <script>
      var months = [
        {
          i: 0,
          name: 'Январь'
        },
        {
          i: 1,
          name: 'Февраль'
        },
        {
          i: 2,
          name: 'Март'
        },
        {
          i: 3,
          name: 'Апрель'
        },
        {
          i: 4,
          name: 'Май'
        },
        {
          i: 5,
          name: 'Июнь'
        },
        {
          i: 6,
          name: 'Июль'
        },
        {
          i: 7,
          name: 'Август'
        },
        {
          i: 8,
          name: 'Сентябрь'
        },
        {
          i: 9,
          name: 'Октябрь'
        },
        {
          i: 10,
          name: 'Ноябрь'
        },
        {
          i: 11,
          name: 'Декабрь'
        },
      ];
      var selectedYear = 1970;
      var maxShowingMonth = 11;
      var selectedMonth = 0;
      var selectedReport = 0;
      function exludeUrl()
      {
        var url = document.location.href;
        var data = url.split('date=');
        if(data.length > 1)
        {
          data = data[1].split('.');
          $('#selectYearReport').val(data[1]);
          $('#selectYearReport').change();
          $('#selectMonthReport').val(Number(data[0])-1);
          $('#selectMonthReport').change();
        }
        else
        {
          var a = new Date();
          $('#selectMonthReport').val(Number(a.getMonth()));
          $('#selectMonthReport').change();

        }
      }
      function fillMonth()
      {
        var a = new Date();
        if(a.getFullYear() > selectedYear)
          maxShowingMonth = 11;
        else
        {
          var month = a.getMonth();
          maxShowingMonth = month;
        }
        selectedMonth = $('#selectMonthReport').val();
        if(maxShowingMonth < selectedMonth)
          selectedMonth = maxShowingMonth;
        $select = $('#selectMonthReport');
        $select.html('');
        $.each(months, function(i, val){
          if(val.i <= maxShowingMonth)
            $select.append($('<option />', { value: val.i, text: val.name, selected: val.i == selectedMonth }));
        });
        $select.selectpicker('refresh');
      }
      function changeYear()
      {
        selectedYear = $('#selectYearReport').val();
        fillMonth();
      }
      function fillYear()
      {
        $select = $('#selectYearReport');
        $select.html('');
        for(var i = 0; i < 20; i++)
          $select.append($('<option />', { value: selectedYear-i, text: selectedYear-i, selected: i==0 }));

        $select.selectpicker('refresh');
      }
      function initReport()
      {
        var a = new Date();
        var month = a.getMonth();
        selectedYear = a.getFullYear();
        //if(month == 0)
        //	selectedYear--;
        if(month > 0)
          maxShowingMonth = month-1;
        selectedMonth = maxShowingMonth;
        fillMonth();
        fillYear();
        exludeUrl();
      }
      function sendReportBegin(id)
      {
        selectedReport = id;
        initReport();
        $('#createReportModal').modal('show');
      }
      function sendReportResult(data)
      {
        console.log(data);
        if(data.reportSendResult.success)
        {
          $('#createReportModal').modal('hide');
          notifyInfo('Отчет успешно отправлен на E-Mail');
        }
        else
          notifyError('Ошибка: '+ data.reportSendResult.result.message);
      }
      function sendReportError(data)
      {
        notifyError('Ошибка отправки запроса.');
      }
      function sendReport()
      {
        rcmsQuery('reports/send/', {month: $('#selectMonthReport').val(), year: $('#selectYearReport').val()}, sendReportResult, sendReportError);
      }
    </script>

    <div class="modal fade" id="createReportModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content p-3">
          <button type="button" class="close bg-danger bclose" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
          <h5 class="modal-title pt-3" id="exampleModalLabel">СВОДНАЯ ВЕДОМОСТЬ</h5>
          <div class="modal-body text-center">
            <div class="row">
              <div class="col-sm p-4">
                <input type="hidden" name="funcId" id="modalFuncId" value="">
                <div class="mb-4 position-relative">
                  <p>Выберите месяц за который требуется отчёт</p>
                  <select id="selectMonthReport" data-width="150px">
                  </select>

                  <select id="selectYearReport" data-width="150px" onchange="changeYear()">
                  </select>
                </div>

                <div class="row" id="modalNonVirtualActionsBox">
                  <button onclick="sendReport()" class="w-100 btn btn-primary p-3">Отправить на user@user.ru</button>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>            		<div class="container-fluid right-part__wrapper  flex-column">
    <script>
      function replaceQueryParam(param, newval, search) {
        var regex = new RegExp("([?;&])" + param + "[^&;]*[;&]?");
        var query = search.replace(regex, "$1").replace(/&$/, '');

        return (query.length > 4 ? query + "&" : "?/?") + (newval ? param + "=" + newval : '');
      }

      function changeDate() {
        var url = document.location.search;
        url = replaceQueryParam('date', $('#dashboardDateSelect').val(), url);
        document.location.href = url;
      }

      function changeType() {
        var url = document.location.search;
        url = replaceQueryParam('type', $('#dashboardTypeSelect').val(), url);
        document.location.href = url;
      }
    </script>
    <div class="text-center" style="margin: calc(100%/2 - 200px) auto;">
      <svg xmlns="http://www.w3.org/2000/svg" width="111" height="99" viewBox="0 0 111 99">
        <g fill="none" fill-rule="evenodd">
          <g fill="#9EA1A3" fill-rule="nonzero">
            <g>
              <g>
                <path d="M72 16v20c-1.363 0-2.7.114-4 .332V20H4v36h44.332c-.218 1.3-.332 2.637-.332 4H12v4H8v-4H0V16h72zM60 28v11.21c-1.433.83-2.774 1.803-4 2.901V32H36v12h18.111c-1.098 1.226-2.071 2.567-2.9 4H32V28h28zM16 40v4h-4v-4h4zm8-8v4H12v-4h12zM72 0v12H0V0h72zm-4 4H4v4h64V4z" transform="translate(-815 -314) translate(631 314) translate(184)"></path>
                <path d="M74.222 40.122c1.663.184 3.264.571 4.778 1.137v24.928h-9.556V71h-4.777v-4.813H52.976c-.498-1.531-.816-3.144-.93-4.813l22.176.001zm-9.555 1.265V51.75H53.776c.795-1.754 1.836-3.373 3.079-4.813h3.034v-2.854c1.45-1.105 3.055-2.017 4.778-2.696z" opacity=".3" transform="translate(-815 -314) translate(631 314) translate(184)"></path>
                <path d="M72 36c13.255 0 24 10.745 24 24 0 4.45-1.211 8.618-3.322 12.191l17.878 17.88-8.485 8.485-17.88-17.878C80.618 82.788 76.451 84 72 84c-13.255 0-24-10.745-24-24s10.745-24 24-24zm15.498 42.326l14.573 14.573 2.828-2.829-14.572-14.573c-.863 1.02-1.81 1.966-2.829 2.829zM72 40c-11.046 0-20 8.954-20 20s8.954 20 20 20 20-8.954 20-20-8.954-20-20-20z" transform="translate(-815 -314) translate(631 314) translate(184)"></path>
              </g>
            </g>
          </g>
        </g>
      </svg>
      <div class="mt-4" style="color: #9ea1a3">
        <span style="font-size: 1.5rem">Нет групп или устройств.</span>
        <p>Вы можете добавить их в разделе Список устройств.</p>
      </div>
    </div>
  </div>








  </main>
</div>
<div class="dcontainer spinnerOverlay">
  <div class="spinner"></div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="./decstream_cp/public/js/jquery.datetimepicker.full.min.js"></script>
<script src="./decstream_cp/public/js/bootstrap.js"></script>
<script>
  jQuery(document).ready(function ($) {
    template.enable();
  });
  $(function () {
    template.postProcessing = function () {

    };
    template.postProcessing();
    subscribe();

  });
  template.version = 'test';

  $(document).ready(function () {
    $(".navbar-toggler").click(function (event) {
      $(".navbar-collapse").collapse('hide');
    });
  });
</script>

<div style="display:block; width:100%;height:5px;position:fixed;top:-12px;left:0;z-index:3000;" id="progressBar"></div>


<div class="offline-ui offline-ui-up"><div class="offline-ui-content"></div><a href="" class="offline-ui-retry"></a></div></body>
</html>
