<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Spinner test</title>
</head>
<body style="padding: 0px;">
<div class="modal fade" id="multipageFiltersModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">НАСТРОЙКА ФИЛЬТРОВ</h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="btn-close"></span>
        </button>
      </div>
      <div class="modal-body">
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_WATER_COUNTER" def-val="unchecked"
                 res-val="unchecked" data-inverse="false">
          <label class="custom-control-label" for="DF_WATER_COUNTER">Водосчетчики</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_ELECTRICITY_COUNTER" def-val="unchecked"
                 res-val="unchecked" data-inverse="false">
          <label class="custom-control-label" for="DF_ELECTRICITY_COUNTER">Электросчетчики</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_GAS_COUNTER" def-val="unchecked"
                 res-val="unchecked" data-inverse="false">
          <label class="custom-control-label" for="DF_GAS_COUNTER">Газосчетчики</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_THERMOMETER" def-val="unchecked"
                 res-val="unchecked" data-inverse="false">
          <label class="custom-control-label" for="DF_THERMOMETER">Датчики температуры</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_HUMIDITY" def-val="unchecked" res-val="unchecked"
                 data-inverse="false">
          <label class="custom-control-label" for="DF_HUMIDITY">Датчики влажности</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_ALARM" def-val="unchecked" res-val="unchecked"
                 data-inverse="false">
          <label class="custom-control-label" for="DF_ALARM">Датчики тревоги</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_OPEN_CLOSE_SENSOR" def-val="unchecked"
                 res-val="unchecked" data-inverse="false">
          <label class="custom-control-label" for="DF_OPEN_CLOSE_SENSOR">Датчики открытия</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_TILT_ANGLE" def-val="unchecked" res-val="unchecked"
                 data-inverse="false">
          <label class="custom-control-label" for="DF_TILT_ANGLE">Датчики наклона</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_SWITCH" def-val="unchecked" res-val="unchecked"
                 data-inverse="false">
          <label class="custom-control-label" for="DF_SWITCH">Переключатели</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_PHASE" def-val="unchecked" res-val="unchecked"
                 data-inverse="false">
          <label class="custom-control-label" for="DF_PHASE">Измерители фазы</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_IMPULSE_COUNTER" def-val="unchecked"
                 res-val="unchecked" data-inverse="false">
          <label class="custom-control-label" for="DF_IMPULSE_COUNTER">Счетчики импульсов</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_GEO_POSITION" def-val="unchecked"
                 res-val="unchecked" data-inverse="false">
          <label class="custom-control-label" for="DF_GEO_POSITION">GPS</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_SECURITY" def-val="unchecked" res-val="unchecked"
                 data-inverse="false">
          <label class="custom-control-label" for="DF_SECURITY">Охрана</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_ILLUMINANCE" def-val="unchecked"
                 res-val="unchecked" data-inverse="false">
          <label class="custom-control-label" for="DF_ILLUMINANCE">Датчики освещённости</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_SOUND_PRESSURE_LEVEL" def-val="unchecked"
                 res-val="unchecked" data-inverse="false">
          <label class="custom-control-label" for="DF_SOUND_PRESSURE_LEVEL">Датчики шума</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_CO2_CONCENTRATION" def-val="unchecked"
                 res-val="unchecked" data-inverse="false">
          <label class="custom-control-label" for="DF_CO2_CONCENTRATION">Датчики CO2</label>
        </div>
        <div class="custom-control custom-checkbox mb-4">
          <input class="custom-control-input" type="checkbox" id="DF_NOTGROUPED" def-val="checked" res-val="unchecked"
                 data-inverse="true" data-selectedurl="devices/groups" data-unselectedurl="devices/list" checked="">
          <label class="custom-control-label" for="DF_NOTGROUPED">Группировать устройства</label>
        </div>

        <div class="row mt-sm-4 btn-line">
          <div class="col-sm-6">
            <a id="filterResetButton" class="btn btn-secondary btn-block pl-4 pr-4">Сбросить все фильтры</a>
          </div>
          <div class="col-sm-6">
            <button type="button" id="filterSubmitButton" class="btn btn-primary btn-block">
              Применить
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  filters.load();
</script>
<div class="modal userbox-modal fade" id="organizationsInfo" tabindex="-1" role="dialog"
     aria-labelledby="organizationInfoLabel" aria-modal="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Информация об аккаунте</h2>
        <button type="button" class="close mobile-only" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="btn-close"></span>
        </button>
      </div>
      <div class="modal-body">
        <div>
          <p>User Test Superra</p>
          <a href="./?/profile/actions/">user@user.ru</a>
        </div>
        <div class="d-flex userbox-buttons">
          <a role="button" href="./?/profile/" class="btn btn-primary btn-custom w-text-uppercase">ИЗМЕНИТЬ</a>
          <a role="button" href="./?/logout" class="btn btn-secondary btn-custom rounded-pill text-uppercase">ВЫЙТИ</a>
        </div>
        <ul class="list-group">
          <li class="list-group-item active"><a href="./?/devices/groups/?organization=10">
            <b>
              User T. S.
            </b>
          </a>
          </li>
          <li class="list-group-item "><a href="./?/devices/groups/?organization=3">

            Хорошая

          </a>
          </li>
          <li class="list-group-item "><a href="./?/devices/groups/?organization=8">

            УК

          </a>
          </li>
          <li class="list-group-item "><a href="./?/devices/groups/?organization=310">

            Томика23

          </a>
          </li>
          <li class="list-group-item "><a href="./?/devices/groups/?organization=1184">

            Тест 404 не трогать

          </a>
          </li>
          <li class="list-group-item "><a href="./?/devices/groups/?organization=261">

            ООО "Декстрим компани"

          </a>
          </li>
          <li class="list-group-item "><a href="./?/devices/groups/?organization=262">

            &lt;i&gt;Водосчетчик&lt;/i&gt;&lt;img src="картинка"/&gt;

          </a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
<script>
  function changeProfileCallback(data) {
    console.log(data);
    if (data.profileChangeResponse.status) {
      showAlert('info', data.profileChangeResponse.message);
      $(
        '#orginfo > div > div > div > div.row.px-4.pt-1.pb-1 > div > p > b')
        .html(
          $('#changeProfileFirst').val() + " "
          + $('#changeProfileMiddle').val() + " "
          + $('#changeProfileLast').val());
      $(
        '#orginfo > div > div > div > div.row.px-4.pt-1.pb-1 > div > p > a')
        .html($('#changeProfileEmail').val());
      $('#changeProfileFirst').attr('def-val',
        $('#changeProfileFirst').val());
      $('#changeProfileMiddle').attr('def-val',
        $('#changeProfileMiddle').val());
      $('#changeProfileLast').attr('def-val',
        $('#changeProfileLast').val());
      $('#changeProfileEmail').attr('def-val',
        $('#changeProfileEmail').val());
      $('#nameinfo').modal('hide');
    } else
      showAlert('danger', data.profileChangeResponse.error);
  }

  function changeProfileData() {
    rcmsQuery('profile/edit', {
      first: $('#changeProfileFirst').val(),
      middle: $('#changeProfileMiddle').val(),
      last: $('#changeProfileLast').val(),
      email: $('#changeProfileEmail').val()
    }, changeProfileCallback, null);
  }
</script>
<div class="modal fade" id="nameinfo" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">ИЗМЕНЕНИЕ ДАННЫХ ПОЛЬЗОВАТЕЛЯ</h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="btn-close"></span>
        </button>
      </div>
      <div class="modal-body">
        <form method="POST" action="/?/profile/edit/">
          <div class="form-group">
            <label for="changeProfileLast">Фамилия</label>
            <input type="text" class="form-control" name="last" id="changeProfileLast" def-val="User" value="User"
                   validate="" data-validator="name">
          </div>
          <div class="form-group">
            <label for="changeProfileFirst">Имя</label>
            <input type="text" class="form-control" name="first" id="changeProfileFirst" def-val="Test" value="Test"
                   validate="" data-validator="name">
          </div>
          <div class="form-group">
            <label for="changeProfileMiddle">Отчество</label>
            <input type="text" class="form-control" name="middle" id="changeProfileMiddle" def-val="Superra"
                   value="Superra" validate="" data-validator="name">
          </div>
          <div class="form-group mb-0">
            <label for="changeProfileEmail">Email</label>
            <input type="text" class="form-control" name="email" id="changeProfileEmail" def-val="Superra"
                   value="user@user.ru" validate="" data-validator="email">
          </div>
          <button type="button" name="save" onclick="changeProfileData()" class="btn btn-primary w-100 mt-40">СОХРАНИТЬ
          </button>
        </form>
      </div>
    </div>
  </div>
</div>
<script>
  $('#nameinfo').on('shown.bs.modal', function () {
    $('#changeProfileLast').focus()
  });
  $('#nameinfo').on(
    'hidden.bs.modal',
    function () {
      $('#changeProfileLast').val(
        $('#changeProfileLast').attr('def-val'));
      $('#changeProfileFirst').val(
        $('#changeProfileFirst').attr('def-val'));
      $('#changeProfileMiddle').val(
        $('#changeProfileMiddle').attr('def-val'));
      $('#changeProfileEmail').val(
        $('#changeProfileEmail').attr('def-val'));
    });
</script>
<script type="text/javascript">

  function mySubmitFunction(e) {
    e.preventDefault();
    changePassCall();
    return false;
  }

  function changePassCallback(data) {
    console.log(data);
    if (data.profileChangeResponse.status) {
      $('#changePasswordModal').modal('hide');
      showAlert('info', data.profileChangeResponse.message);
      $('#changePassOldPass').val('');
      $('#changePassNewPass').val('');
      $('#changePassNewPassR').val('');
    } else {
      showAlert('danger', data.profileChangeResponse.error);
    }
  }

  function changePassCall() {
    if ($('#changePassNewPass').val() == $('#changePassNewPassR').val()) {
      rcmsQuery('profile/edit', {
        old_password: $('#changePassOldPass').val(),
        new_password: $('#changePassNewPass').val(),
        new_password_r: $('#changePassNewPassR').val()
      }, changePassCallback, null);
    } else {
      showAlert('warning', arn('Повтор пароля не совпадает с новым паролем'));
      $('#changePassNewPassR').val('');
    }
  }
</script>

<div class="modal fade" id="changePasswordModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">ИЗМЕНЕНИЕ ПАРОЛЯ</h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="btn-close"></span>
        </button>
      </div>
      <div class="modal-body">
        <form method="POST" action="/?/profile/edit/" onsubmit="return mySubmitFunction(event)"
              oninput="new_password_r.setCustomValidity(new_password.value !== new_password_r.value ? &quot;Повтор пароля не совпадает с новым паролем&quot; : &quot;&quot;)">
          <div class="form-group">
            <label for="changePassOldPass">Старый пароль</label>
            <input type="password" class="form-control" name="old_password" id="changePassOldPass" def-val="">
          </div>
          <div class="form-group">
            <label for="changePassNewPass">Новый пароль</label>
            <input type="password" class="form-control" name="new_password" id="changePassNewPass" def-val="">
          </div>
          <div class="form-group">
            <label for="changePassNewPassR">Повторить пароль</label>
            <input type="password" class="form-control" name="new_password_r" id="changePassNewPassR" def-val="">
          </div>
          <button id="registerButton" name="save" type="submit" class="btn btn-primary w-100 mt-40">
            Изменить
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  $('#changePasswordModal').on('hidden.bs.modal', function () {
    $('#changePassOldPass').val('');
    $('#changePassNewPass').val('');
    $('#changePassNewPassR').val('');
  });
</script>
<div class="modal fade" id="inviteAcceptModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ПРИГЛАШЕНИЕ В ОРГАНИЗАЦИЮ</h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="btn-close"></span>
        </button>
      </div>
      <div class="modal-body">
        <div class="text-center">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.552cm"
               height="1.552cm">
            <path fill-rule="evenodd" fill="rgb(74, 189, 126)"
                  d="M22.253,43.061 C10.417,43.061 0.788,33.432 0.788,21.596 C0.788,9.760 10.417,0.131 22.253,0.131 C34.089,0.131 43.718,9.760 43.718,21.596 C43.718,33.432 34.089,43.061 22.253,43.061 ZM22.253,2.561 C11.757,2.561 3.218,11.100 3.218,21.596 C3.218,32.092 11.757,40.631 22.253,40.631 C32.749,40.631 41.288,32.092 41.288,21.596 C41.288,11.100 32.749,2.561 22.253,2.561 ZM20.731,28.883 C20.501,29.143 20.170,29.291 19.823,29.291 C19.549,29.291 19.279,29.197 19.064,29.026 L10.964,22.545 C10.710,22.342 10.551,22.053 10.515,21.730 C10.479,21.408 10.572,21.091 10.774,20.837 C10.977,20.584 11.266,20.425 11.589,20.389 C11.912,20.353 12.229,20.445 12.481,20.647 L19.681,26.407 L31.874,12.690 C32.091,12.446 32.387,12.302 32.712,12.283 C33.031,12.262 33.347,12.372 33.591,12.589 C33.833,12.803 33.977,13.100 33.996,13.424 C34.016,13.749 33.907,14.061 33.691,14.304 L20.731,28.883 Z"></path>
          </svg>
        </div>
        <p>Ваше приглашение в организацию "" активировано.</p>
      </div>
    </div>
  </div>
</div>


<header>
  <div class="wrapper">
    <div class="left-part">
      <div class="left-part__wrapper">
        <div class="hamburger-menu">
          <input id="menu__toggle" type="checkbox" onclick="changePageScrolling()">
          <label class="menu__btn" for="menu__toggle">
            <span></span>
          </label>
          <div class="aside-menu menu__box container-fluid mt-3" id="homeSubmenuMobile">
            <div class="aside-menu-item">
              <a href="./?/" class="w-100 d-block ">
                <img src="./decstream_cp/public/images/menuIcons/jkh.svg">
                ЖКХ
              </a>
            </div>
            <div class="aside-menu-item">
              <a href="./?/devices/groups/" class="w-100 d-block ">
                <img src="./decstream_cp/public/images/menuIcons/devices.svg">
                Список устройств
              </a>
            </div>
            <div class="aside-menu-item">
              <a href="./?/events/" class="w-100 d-block active">
                <img src="./decstream_cp/public/images/menuIcons/events_active.svg">
                Журнал событий
              </a>
            </div>
            <div class="aside-menu-item">
              <a href="./?/reports/" class="w-100 d-block ">
                <img src="./decstream_cp/public/images/menuIcons/reports.svg">
                Отчеты
              </a>
            </div>
            <div class="aside-menu-item">
              <a href="./?/members/" class="w-100 d-block ">
                <img src="./decstream_cp/public/images/menuIcons/users.svg">
                Пользователи и роли
              </a>
            </div>
            <div class="menu-bottom">
              <div class="userbox text-left align-items-center" style="cursor:pointer;" data-toggle="modal"
                   data-target="#organizationsInfo">
                <div class="text-left">
                  User T. S.
                  <br>
                  <b>User T. S.</b>
                </div>
                <i class="fa fa-angle-down pl-3" style="color:#c94e60; font-weight: 600;" aria-hidden="true"></i>
              </div>
            </div>
          </div>
        </div>
        <script>
          function changePageScrolling() {
            let body = document.body;
            body.className = '';
            if ($('#menu__toggle').prop('checked')) {
              body.className = 'overflow-hidden';
            }
          }
        </script>
        <div class="logo">
          <a href="/">
            <img src="./decstream_cp/public/images/logo.png" alt="logo">
          </a>
          <button onclick="template.cache.forceClear();"
                  style="position: absolute;top: 15px;left: 28px;width: 21px;height: 27px;opacity: 0"></button>
        </div>
      </div>
    </div>
    <div class="right-part pl-3">
      <div class="right-part__wrapper">
        <nav aria-label="breadcrumb" class="d-flex align-items-center w-100">
          <a class="bc-row-back" href="./?/events/"><img src="./decstream_cp/public/images/arrow-back.svg"></a>
          <ol class="breadcrumb align-items-center" id="breadcrumbs">
            <li class="breadcrumb-item active" aria-current="page">
              <span>Устройства</span>
            </li>
          </ol>
        </nav>
        <script>
          function hideBackBtn() {
            if (window.outerWidth < 768) {
              let block = document.querySelector('#breadcrumbs');
              let breadcrumbs = block.querySelectorAll('ol.breadcrumb>.breadcrumb-item');
              let backBtn = block.querySelector('.bc-row-back');
              backBtn.className = 'bc-row-back';
              if (breadcrumbs.length <= 1) {
                backBtn.className = backBtn.className + ' hide';
              }
            }
          }

          hideBackBtn();
          $(window).resize(function () {
              hideBackBtn();
            }
          )
        </script>
        <div class="userbox text-right align-items-center" id="profileInfoBtn" style="cursor:pointer;"
             data-toggle="modal" data-target="#organizationsInfo">
          <div class="float-left">
            <span class="text-nowrap">User T. S.</span>
            <br>
            <b class="text-nowrap">User T. S.</b>
          </div>
          <i class="fa fa-angle-down pl-3" style="color:#c94e60; font-weight: 600;" aria-hidden="true"></i>
        </div>
        <div class="logo tablet-only p-0">
          <a href="/">
            <img src="./decstream_cp/public/images/logo.png" alt="logo">
          </a>
        </div>
      </div>
    </div>
  </div>
</header>
<div class="page-content" id="pageContent">
  <aside class="left-part">
    <div class="left-part__wrapper">
      <ul class="aside-menu container-fluid" id="homeSubmenu2">
        <li>
          <a href="./?/" class="w-100 d-block ">
            <img src="./decstream_cp/public/images/menuIcons/jkh.svg">
            ЖКХ
          </a>
        </li>
        <li>
          <a href="./?/devices/groups/" class="w-100 d-block active">
            <img src="./decstream_cp/public/images/menuIcons/devices_active.svg">
            Список устройств
          </a>
        </li>
        <li>
          <a href="./?/events/" class="w-100 d-block ">
            <img src="./decstream_cp/public/images/menuIcons/events.svg">
            Журнал событий
          </a>
        </li>
        <li>
          <a href="./?/reports/" class="w-100 d-block ">
            <img src="./decstream_cp/public/images/menuIcons/reports.svg">
            Отчеты
          </a>
        </li>
        <li>
          <a href="./?/members/" class="w-100 d-block ">
            <img src="./decstream_cp/public/images/menuIcons/users.svg">
            Пользователи и роли
          </a>
        </li>
      </ul>
    </div>
  </aside>
  <main id="mainBlock" class="right-part" style="pointer-events: auto; opacity: 1;">
    <div class="spinner-overlay" style="z-index: 10;background: rgba(242, 244, 247, 0.8);">
      <div class="spinner" style="font-size: 56px;text-align: center;line-height: 30px;">c</div>
    </div>
    <div class="modal fade" id="addhard" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h2 class="modal-title" id="addDeviceModalTitle">
              ДОБАВИТЬ

            </h2>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true" class="btn-close"></span>
            </button>
          </div>
          <div class="modal-body" id="selectDeviceOrGroup">
            <button class="btn btn-primary w-100 mb-4"
                    onclick="$('#selectDeviceOrGroup,#addVirtualDeviceTile').hide();$('#addDeviceTile').show();">
              Устройство
            </button>
            <button class="btn btn-primary w-100 mb-4"
                    onclick="$('#selectDeviceOrGroup').hide();$('#addVirtualDeviceTile,#addVirtualDeviceTypeTile').show();">
              <span>Прибор учёта</span>
              <span>с импульсным выходом</span>
            </button>
            <button class="btn btn-primary w-100"
                    onclick="$('#selectDeviceOrGroup,#addVirtualDeviceTile').hide();$('#addGroupTile').show();">
              Группу
            </button>
          </div>
          <script>
            var vType = '';
            var sourceDevices = [];
            var selectedDeviceIterator = -1;
            var selectedFunctionIterator = -1;
            var newVirtualDeviceName = '';
            var newVirtualDeviceSerial = '';
            var newVirtualDeviceFactor = 0;
            var newVirtualDeviceCost = 0;
            var newVirtualDevicePurpose = 'NONE';
            var sourceDeviceTemperatureFuncId = -1;

            function createVirtualDeviceCallback(data) {
              console.log(data);
              if (!data.virtualDeviceCreation.status)
                notifyError(data.virtualDeviceCreation.error);
              else
                template.redirect("./?/devices/info/?id=" + data.virtualDeviceCreation.device.device.id);
            }

            function createVirtualDeviceFinish() {
              newVirtualDevicePurpose = $('#addVirtualDevicePurposeSelect').val();
              currentValue = $('#addVirtualDeviceFactorInput').val();
              newVirtualDeviceCost = $('#addVirtualDeviceCostInput').val();
              rcmsQuery('devices/add/?virtual&group=10', {
                type: vType,
                sourceDeviceId: sourceDevices[selectedDeviceIterator].id,
                sourceFunctionId: sourceDevices[selectedDeviceIterator].functions[selectedFunctionIterator].id,
                sourceFunctionValue: sourceDevices[selectedDeviceIterator].functions[selectedFunctionIterator].data.count,
                name: newVirtualDeviceName,
                serial: newVirtualDeviceSerial,
                currentValue: currentValue,
                cost: newVirtualDeviceCost,
                purpose: newVirtualDevicePurpose,
                temperatureFunc: sourceDeviceTemperatureFuncId
              }, createVirtualDeviceCallback, null);
            }

            function createVirtualDeviceToFactor() {
              newVirtualDeviceName = $('#addVirtualDeviceNameInput').val();
              newVirtualDeviceSerial = $('#addVirtualDeviceSerialInput').val();
              if (newVirtualDeviceName == '' || newVirtualDeviceSerial == '')
                showAlert('warning', arn('Все поля обязательны к заполнению!'));
              else {
                $('#addVirtualDeviceCostAndFactor').show();
                $('#addVirtualDeviceNameAndSerial').hide();
                if (vType == 'WATER_COUNTER')
                  $('#addVirtualWaterPurpose').show();
                else
                  $('#addVirtualWaterPurpose').hide();
              }
            }

            function createVirtualDeviceSelectSourceExit(func_id) {
              selectedFunctionIterator = func_id;
              $('#addVirtualDeviceNameInput, #addVirtualDeviceSerialInput').val('');
              $('#addVirtualDeviceNameAndSerial').show();
              $('#addVirtualDeviceSelectExit').hide();

            }

            function createVirtualDeviceSelectSource(id) {
              selectedDeviceIterator = id;
              $('#addVirtualDeviceSelectSource').hide();
              $('#addVirtualDeviceSelectExit').show();
              var $select = $('#virtualDeviceSelectSourceExit');
              $select.html('');

              for (var i = 0; i < sourceDevices[id].functions.length; i++) {
                if (sourceDevices[id].functions[i].type == 'THERMOMETER')
                  sourceDeviceTemperatureFuncId = sourceDevices[id].functions[i].id;
                else {
                  if (sourceDevices[id].functions[i].type == 'IMPULSE_COUNTER')
                    $select.append($("<div class=\"borderIndicator\">" +
                      "<a onclick=\"createVirtualDeviceSelectSourceExit(" + i + ")\" style=\"cursor: pointer;\">" +
                      "<li class=\"text-primary\"><b class=\"p-2\">" + sourceDevices[id].functions[i].name + "</b></li></a>" +
                      "</div>", null));
                }
              }

            }

            function getSourceDevicesCallback(data) {
              console.log(data);
              var $select = $('#virtualDeviceSelectSource');
              $select.html('');
              //for(var j = 0; j < 20; j++)
              sourceDevices = data.sourceDevices.data.device_contexts;
              for (var i = 0; i < data.sourceDevices.data.device_contexts.length; i++) {
                $select.append($("<div class=\"borderIndicator\">" +
                  "<a onclick=\"createVirtualDeviceSelectSource(" + i + ")\" style=\"cursor: pointer;\">" +
                  "<li class=\"text-primary\"><b class=\"p-2\">" + data.sourceDevices.data.device_contexts[i].name + "</b></li></a>" +
                  "</div>", null));
              }
            }

            function createVirtualDeviceSelectType(type) {
              vType = type;
              var typeName = 'ДОБАВИТЬ ';
              switch (vType) {
                case 'WATER_COUNTER':
                  typeName += 'ВОДОСЧЁТЧИК';
                  break;
                case 'ELECTRICITY_COUNTER':
                  typeName += 'ЭЛЕКТРОСЧЁТЧИК';
                  break;
                case 'GAS_COUNTER':
                  typeName += 'ГАЗОСЧЁТЧИК';
                  break;
              }
              $('#addDeviceModalTitle').html(typeName);
              $('#addVirtualDeviceTypeTile').hide();
              $('#addVirtualDeviceSelectSource').show();
              rcmsQuery('devices/list/?getSourceDevices', null, getSourceDevicesCallback, null);
            }
          </script>
          <div class="modal-body" id="addVirtualDeviceTile" style="display:none;">
            <div id="addVirtualDeviceTypeTile">
              <button class="btn btn-primary w-100 mb-3" onclick="createVirtualDeviceSelectType('WATER_COUNTER')">
                Водосчётчик
              </button>
              <button class="btn btn-primary w-100 mb-3" onclick="createVirtualDeviceSelectType('ELECTRICITY_COUNTER')">
                Электросчётчик
              </button>
              <button class="btn btn-primary w-100" onclick="createVirtualDeviceSelectType('GAS_COUNTER')">
                Газосчётчик
              </button>
              <button onclick="$('#addVirtualDeviceTypeTile').hide();$('#selectDeviceOrGroup').show();"
                      class="btn btn-primary w-100 mt-40">Назад
              </button>
            </div>
            <div id="addVirtualDeviceSelectSource" class="row" style="display:none;">
              <div class="col-sm">
                <ul id="virtualDeviceSelectSource">
                </ul>
                <button onclick="$('#addVirtualDeviceSelectSource').hide();$('#addVirtualDeviceTypeTile').show();"
                        class="btn btn-primary w-100 mt-40">Назад
                </button>
              </div>
            </div>
            <div id="addVirtualDeviceSelectExit" class="row" style="display:none;">
              <div class="col-sm">
                <ul id="virtualDeviceSelectSourceExit">
                </ul>
                <button onclick="$('#addVirtualDeviceSelectExit').hide();$('#addVirtualDeviceSelectSource').show();"
                        class="btn btn-primary w-100 mt-40">Назад
                </button>
              </div>
            </div>
            <div id="addVirtualDeviceNameAndSerial" style="display:none">
              <p>Введите название и серийный номер добавляемого устройства</p>
              <div class="form-group">
                <label for="addVirtualDeviceNameInput">Название</label>
                <input type="text" class="form-control" id="addVirtualDeviceNameInput">
              </div>
              <div class="form-group">
                <label for="addVirtualDeviceSerialInput">Серийный номер</label>
                <input type="text" class="form-control" id="addVirtualDeviceSerialInput">
              </div>
              <div class="row mt-sm-4 btn-line">
                <div class="col-sm-6">
                  <button onclick="$('#addVirtualDeviceNameAndSerial').hide();$('#addVirtualDeviceSelectExit').show();"
                          class="btn btn-secondary btn-block">Назад
                  </button>
                </div>
                <div class="col-sm-6">
                  <button class="btn btn-primary btn-block" onclick="createVirtualDeviceToFactor()">
                    Далее
                  </button>
                </div>
              </div>
            </div>
            <div id="addVirtualDeviceCostAndFactor" style="display:none">
              <p>Введите цену одного импульса и текущие показания счетчика</p>
              <div class="form-group">
                <label for="addVirtualDeviceCostInput">Цена импульса</label>
                <input type="number" class="form-control" id="addVirtualDeviceCostInput">
              </div>
              <div class="form-group">
                <label for="addVirtualDeviceFactorInput">Текущие показания</label>
                <input type="number" class="form-control" id="addVirtualDeviceFactorInput">
              </div>
              <div id="addVirtualWaterPurpose" class="w-100" style="display:none;">
                <span>Назначение</span>
                <div class="form-group">
                  <select class="form-control" id="addVirtualDevicePurposeSelect">
                    <option value="NONE">Не задано</option>
                    <option value="COLD_WATER">Холодная вода</option>
                    <option value="HOT_WATER">Горячая вода</option>
                  </select>
                </div>
              </div>
              <div class="row mt-sm-4 btn-line">
                <div class="col-sm-6">
                  <button
                    onclick="$('#addVirtualDeviceCostAndFactor').hide();$('#addVirtualDeviceNameAndSerial').show();"
                    class="btn btn-secondary btn-block">Назад
                  </button>
                </div>
                <div class="col-sm-6">
                  <button class="btn btn-primary btn-block" onclick="createVirtualDeviceFinish()">
                    Добавить
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-body" id="addDeviceTile" style="display:none;">
            <script>
              function addSimpleDeviceCallback(data) {
                if (data.addDeviceResult.status)
                  template.reload();
                else
                  notifyError(data.addDeviceResult.message);
              }

              function addSimpleDevice() {
                rcmsQuery('devices/add/?group=10', {
                  addDevice: true,
                  deviceEui: $('#deviceDevEUI').val()
                }, addSimpleDeviceCallback, null);
              }
            </script>
            <p>Введите номер устройства (DEV EUI) написанный на коробке.</p>
            <div class="form-group">
              <label for="deviceDevEUI">Номер устройства</label>
              <input type="text" class="form-control" id="deviceDevEUI">
            </div>
            <div class="row mt-sm-4 btn-line">
              <div class="col-sm-6">
                <button onclick="$('#addDeviceTile').hide();$('#selectDeviceOrGroup').show();"
                        class="btn btn-secondary btn-block">Назад
                </button>
              </div>
              <div class="col-sm-6">
                <button class="btn btn-primary btn-block" onclick="addSimpleDevice()">
                  ДОБАВИТЬ
                </button>
              </div>
            </div>
          </div>
          <div class="modal-body" id="addGroupTile" style="display:none;">
            <p>Введите название группы.</p>
            <script>
              function createGroupCallback(data) {
                if (data.groupCreateResult.status)
                  template.reload();
                else
                  notifyError(data.groupCreateResult.error);
              }

              function createGroup() {
                rcmsQuery('devices/add/?group=10&addGroup', {groupName: $('#addGroupInput').val()}, createGroupCallback, null);
              }
            </script>
            <form method="POST" id="createGroupForm" action="/?/devices/add/?group=10&amp;addGroup">
              <div class="form-group">
                <label for="addGroupInput">Название группы</label>
                <input type="text" class="form-control" id="addGroupInput" name="groupName">
              </div>
              <div class="row mt-sm-4 btn-line">
                <div class="col-sm-6">
                  <button onclick="$('#addGroupTile').hide();$('#selectDeviceOrGroup').show();"
                          class="btn btn-secondary btn-block">Назад
                  </button>
                </div>
                <div class="col-sm-6">
                  <button class="btn btn-primary btn-block">
                    ДОБАВИТЬ
                  </button>
                </div>
              </div>
            </form>
            <script>
              $("#createGroupForm").submit(function (e) {
                createGroup();
                return false;
              });
            </script>
          </div>
        </div>
      </div>
    </div>
    <script>
      $('#addhard').on('shown.bs.modal', function () {
        $('#addHardInput').focus()
      });
      $('#addhard').on('hidden.bs.modal', function () {
        $('#addHardInput,#addGroupInput').val('');
        $('#selectDeviceOrGroup').show();
        $('#addDeviceModalTitle').html('ДОБАВИТЬ');
        $('#addDeviceTile,#addGroupTile,#addVirtualDeviceCostAndFactor,#addVirtualDeviceNameAndSerial,#addVirtualDeviceSelectExit,#addVirtualDeviceSelectSource,#addVirtualDeviceTypeTile').hide();
        $('#addGroupTile,#addDeviceTile').hide();

      })
      ;

    </script>
    <div class="container-fluid right-part__wrapper flex-column">
      <div class="group-address">

      </div>
      <div class="mb-40">
        <button class="btn btn-primary btn-round" data-toggle="modal" data-target="#multipageFiltersModal">
          <i class="fa fa-filter" aria-hidden="true" style="font-size: 1.3rem;vertical-align: middle;"></i>
        </button>
        <button class="btn btn-secondary ml-4 mr-sm-4" data-toggle="modal" data-target="#addhard">добавить</button>
      </div>

      <div class="table-responsive table-cover desktop-only">
        <table class="table table-list with-icons">
          <thead>
          <tr>
            <th class="pr-0">Тип</th>
            <th class="pl-3">Оборудование</th>
            <th class="text-center">Функция</th>
            <th>Обновление</th>
            <th></th>
            <th></th>
          </tr>
          </thead>
          <tbody>
          <tr data-role="link" data-href="./?/devices/groups/?group=4176" class="mgroup" style="cursor: pointer;">
            <td class="pr-0">
              <img class="deviceIcon" src="./decstream_cp/public/images/icons/folder.svg">
            </td>
            <td class="pl-0">23121323</td>
            <td>
            </td>
            <td></td>
            <td></td>
            <td class="pl-0"><img src="./decstream_cp/public/images/arrow-forth.svg"></td>
          </tr>
          <tr data-role="link" class="" data-href="./?/devices/info/?id=1765" style="cursor: pointer;">
            <td class="pr-0">
    	                    <span>
    	                        <img title="UM0101" class="deviceIcon"
                                   src="./decstream_cp/public/images/icons/devices/deviceIcons/icon-device.svg">
                            <!--  -->
    	                    </span>
            </td>
            <td class="pl-0">&lt;i&gt;string99&lt;/i&gt;</td>
            <td>
            </td>
            <td>
              01.01.2023
            </td>
            <td>
              14:05:43
            </td>
            <td class="pl-0"><img src="./decstream_cp/public/images/arrow-forth.svg"></td>
          </tr>

          <tr data-role="link" class="" data-href="./?/devices/info/?id=2297" style="cursor: pointer;">
            <td class="pr-0">
    	                    <span>
    	                        <img title="СИ-12" class="deviceIcon"
                                   src="./decstream_cp/public/images/icons/devices/deviceIcons/dev-test.svg">
                            <!--  -->
    	                    </span>
            </td>
            <td class="pl-0">Вега СИ-12 514</td>
            <td>
            </td>
            <td>
              13.10.2021
            </td>
            <td>
              12:25:00
            </td>
            <td class="pl-0"><img src="./decstream_cp/public/images/arrow-forth.svg"></td>
          </tr>

          <tr data-role="link" class="" data-href="./?/devices/info/?id=2369" style="cursor: pointer;">
            <td class="pr-0">
    	                    <span>
    	                        <img title="СИ-11" class="deviceIcon"
                                   src="./decstream_cp/public/images/icons/devices/deviceIcons/dev-test.svg">
                            <!--  -->
    	                    </span>
            </td>
            <td class="pl-0">Вега СИ-11 2369</td>
            <td>
            </td>
            <td>
              13.10.2021
            </td>
            <td>
              08:00:00
            </td>
            <td class="pl-0"><img src="./decstream_cp/public/images/arrow-forth.svg"></td>
          </tr>

          <tr data-role="link" class="" data-href="./?/devices/info/?id=2475" style="cursor: pointer;">
            <td class="pr-0">
    	                    <span>
    	                        <img title="СИ-22" class="deviceIcon"
                                   src="./decstream_cp/public/images/icons/devices/deviceIcons/dev-test.svg">
                            <!--  -->
    	                    </span>
            </td>
            <td class="pl-0">Вега СИ-22 2432</td>
            <td>
            </td>
            <td>
              13.10.2021
            </td>
            <td>
              11:00:00
            </td>
            <td class="pl-0"><img src="./decstream_cp/public/images/arrow-forth.svg"></td>
          </tr>

          </tbody>
        </table>
      </div>


    </div>


  </main>
</div>
</body>
</html>
